name: Win - Build & Test VCS plugins
agent:
    type: Unity::VM
    image: core-kaunas/win10-vs2010:latest
    flavor: b1.large
    
interpreter: powershell    
commands:
        - perl build.pl | tee win_build.txt
        - hg clone http://hg-mirror-slo.hq.unity3d.com/unity-extra/perforce PerforceBinaries
        - |
        - echo [extensions] >> PerforceBinaries\.hg\hgrc
        - echo largefiles =  >> PerforceBinaries\.hg\hgrc
        - hg update -C --cwd PerforceBinaries
        - perl build.pl -test | tee win_test.txt
                
artifacts:
    binaries:
      paths:
        - "Build/Win32/*"
    logs:
      paths:
        - "win_build.txt"
        - "win_test.txt"